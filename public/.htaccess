# Désactiver l'index des répertoires
Options -Indexes

# Empêcher l'accès aux fichiers sensibles
<Files ~ "^(\.env|composer\.(json|lock)|package(-lock)?\.json)$">
    Order allow,deny
    Deny from all
</Files>

# Protéger les dossiers sensibles
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /Plateformeval/public/

    # Redirection pour éviter la duplication des URL
    RewriteCond %{REQUEST_URI} ^/Plateformeval/public/(.*)$
    RewriteRule ^Plateformeval/public/(.*)$ /$1 [R=301,L]

    # Servir directement les fichiers et répertoires existants
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # Tout le reste vers index.php
    RewriteRule ^(.*)$ index.php [QSA,L]
</IfModule>

# Protection supplémentaire
<IfModule mod_headers.c>
    # Désactiver la signature du serveur
    ServerSignature Off
    
    # Cacher les informations sur le serveur
    Header unset X-Powered-By
    Header always unset X-Powered-By
    
    # Protection contre le clickjacking
    Header always append X-Frame-Options SAMEORIGIN
    
    # Protection XSS
    Header set X-XSS-Protection "1; mode=block"
    
    # Protection contre le MIME-type sniffing
    Header set X-Content-Type-Options "nosniff"
</IfModule>

# Protection des fichiers sensibles
<Files ~ "^\.">
    Order allow,deny
    Deny from all
</Files>

# Limiter les méthodes HTTP autorisées
<LimitExcept GET POST PUT DELETE OPTIONS>
    Order deny,allow
    Deny from all
</LimitExcept>